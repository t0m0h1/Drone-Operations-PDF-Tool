<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Drone Pre-Flight Checklist</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="p-4">
  <h1>Drone Pre-Flight Checklist</h1>

  {% if logo %}
    <img src="{{ url_for('static', filename='uploads/' ~ logo) }}" style="height: 100px;" class="mb-3" />
  {% endif %}

  <form method="post" enctype="multipart/form-data" class="mb-5">

    <div class="mb-3">
      <label class="form-label">Upload Company Logo:</label>
      <input type="file" name="logo" class="form-control" />
    </div>

    {% for section, subsections in predefined.items() %}
      <div class="mb-4 border rounded p-3">
        <h2>{{ section }}</h2>
        {% for subsection, items in subsections.items() %}
          <fieldset class="mb-3">
            <legend><strong>{{ subsection }}</strong></legend>

            <div class="row row-cols-1 row-cols-md-2 g-2">
              {% for item in items %}
                <div class="col">
                  <div class="form-check">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="predefined-{{ section }}-{{ subsection }}-{{ loop.index0 }}"
                      name="predefined-{{ section }}-{{ subsection }}"
                      value="{{ item }}"
                      {% if item in checklists[section][subsection] %}checked{% endif %}
                    />
                    <label class="form-check-label" for="predefined-{{ section }}-{{ subsection }}-{{ loop.index0 }}">
                      {{ item }}
                    </label>
                  </div>
                </div>
              {% endfor %}
            </div>

            {% if checklists[section][subsection] %}
              <ul class="list-group mt-3">
                {% for item in checklists[section][subsection] %}
                  <li class="list-group-item d-flex justify-content-between align-items-center">
                    {{ item }}
                    <a href="{{ url_for('delete_item', section=section, subsection=subsection, index=loop.index0) }}" class="btn btn-sm btn-danger">Delete</a>
                  </li>
                {% endfor %}
              </ul>
            {% endif %}

            <div class="input-group mt-3">
              <input
                type="text"
                name="custom-item"
                placeholder="Add custom item..."
                class="form-control"
              />
              <input type="hidden" name="custom-section" value="{{ section }}" />
              <input type="hidden" name="custom-subsection" value="{{ subsection }}" />
              <button type="submit" class="btn btn-primary">Add</button>
            </div>
          </fieldset>
        {% endfor %}
      </div>
    {% endfor %}

  </form>
  <p>Make sure you have all the info correct before downloading.</p>
  <a href="{{ url_for('download_pdf') }}" class="btn btn-success">Download PDF</a>
</body>
</html>
